capture.output(anova(erp.model))
typeof(capture.output(anova(erp.model)))
text(capture.output(anova(erp.model)))
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
text(capture.output(anova(erp.model)))
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
?labs
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
labs(
tag = capture.output(anova(erp.model))
)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
labs(
subtitle = capture.output(anova(erp.model))
)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
capture.output(anova(erp.model))[1]
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
labs(
subtitle = paste(capture.output(anova(erp.model))[1],
capture.output(anova(erp.model))[2],
capture.output(anova(erp.model))[3],
capture.output(anova(erp.model))[4],
capture.output(anova(erp.model))[5],
capture.output(anova(erp.model))[6])
)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
labs(
subtitle = paste(capture.output(anova(erp.model))[1], "\n",
capture.output(anova(erp.model))[2],
capture.output(anova(erp.model))[3],
capture.output(anova(erp.model))[4],
capture.output(anova(erp.model))[5],
capture.output(anova(erp.model))[6])
)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
labs(
subtitle = paste(capture.output(anova(erp.model))[1], "\n",
capture.output(anova(erp.model))[2], "\n",
capture.output(anova(erp.model))[3], "\n",
capture.output(anova(erp.model))[4], "\n",
capture.output(anova(erp.model))[5], "\n",
capture.output(anova(erp.model))[6])
)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
capture.output(anova(erp.model))
capture.output(anova(erp.model))[1]
capture.output(anova(erp.model))[2]
capture.output(anova(erp.model))[3]
capture.output(anova(erp.model))[4]
capture.output(anova(erp.model))[5]
capture.output(anova(erp.model))[6]
capture.output(anova(erp.model))[7]
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
for (i in seq_len(length(post.hoc$contrast))) {
contrast <- strsplit(post.hoc$contrast[i], " ")[[1]]  # split by spaces
if (contrast[2] == contrast[5]) {  # if this contrast is all 1 stimulus, we're interested
Stimulus <- substrRight(contrast[2], 1)  # grab just the number
group1 <- contrast[1]
group2 <- contrast[4]
p <- post.hoc$p.value[i]
newRow <- data.frame(Stimulus, group1, group2, p, height)
colnames(newRow) <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- rbind(stats, newRow)
}
}
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
# P2 AMPLITUDE
model(erp, "P2_Amp")
# Gamma AMPLITUDE
model(freq, "Gamma_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="red", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="point", lwd=1, lty=1)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex") +
stat_summary(fun=mean, colour="red", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_summary(fun=mean, colour="black", aes(group=2),
geom="point")
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex", facet.by = "Stimulus") +
stat_summary(fun=mean, colour="red", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_summary(fun=mean, colour="black", aes(group=2),
geom="point")
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "tukey"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex", facet.by = "Stimulus") +
stat_summary(fun=mean, colour="red", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_summary(fun=mean, colour="black", aes(group=2),
geom="point", size=2)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
# P2 AMPLITUDE
model(erp, "P2_Amp")
# Gamma AMPLITUDE
model(freq, "Gamma_Amp")
model <- function(df, title) {
temp <- subset(df, df$Component==title)
erp.model <- lmer(Value ~ Sex * Stimulus + (1|ID), data = temp, REML = TRUE)
print(anova(erp.model))  # look for main effects/interactions
print(rand(erp.model))  # look at the significance of our random effect (subject)
post.hoc <- data.frame(pairs(emmeans(erp.model, ~ Sex * Stimulus), adjust = "bonferroni"))
post.hoc$Signif <- signif(post.hoc$p.value)
print(post.hoc)
# shape post.hoc so that we can plot it easier
height <- max(temp$Value)
columns <- c("Stimulus", "group1", "group2", "p", "y.position")
stats <- data.frame(matrix(nrow = 0, ncol = length(columns)))
colnames(stats) = columns
# check residuals
#R = residuals(erp.model)
#ggqqplot(R)
# plot results
ggboxplot(temp, x = "Sex", y = "Value",
color = "Stimulus", palette = c("#028090", "#C64191", "#157F1F"),
ylab = title, xlab = "Sex", facet.by = "Stimulus") +
stat_summary(fun=mean, colour="red", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="point", size=2)
}
# N1 AMPLITUDE
model(erp, "N1_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
# P2 AMPLITUDE
model(erp, "P2_Amp")
# Gamma AMPLITUDE
model(freq, "Gamma_Amp")
# P2 AMPLITUDE
model(erp, "P2_Amp")
# N2 AMPLITUDE
model(erp, "N2_Amp")
simple_model <- function(df, title, ignore) {
temp <- subset(df, df$Component==title & !(df$ID %in% ignore))
temp <- temp[!duplicated(temp), ]  # remove any duplicated rows
erp.model <- anova_test(data = temp, dv = Value, wid = ID, within = Stimulus)
post.hoc <- pairwise_t_test(temp, Value ~ Stimulus, paired = TRUE, p.adjust.method = "bonferroni")
post.hoc <- add_xy_position(post.hoc, x = "Stimulus")
print(erp.model)
height <- max(temp$Value)
ggboxplot(temp, x = "Stimulus", y = "Value",
color = "Stimulus", palette = c("#00AFBB", "#E7B800", "#A03D41"),
ylab = title, xlab = "Stimulus") +
stat_summary(fun=mean, colour="black", aes(group=1),
geom="line", lwd=1, lty=1) +
stat_pvalue_manual(post.hoc, tip.length = 0, hide.ns = FALSE, y.position = c(height+1, height+2, height+3)) +
labs(
subtitle = get_test_label(erp.model, detailed = TRUE),
caption = get_pwc_label(post.hoc)
)
}
# Gamma_Amp as a factor of Stimulus intensity alone?
simple_model(freq, "Gamma_Amp", ignore=c())
